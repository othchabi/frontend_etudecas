var y=Object.defineProperty,I=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var m=(t,e,s)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,v=(t,e)=>{for(var s in e||(e={}))b.call(e,s)&&m(t,s,e[s]);if(_)for(var s of _(e))F.call(e,s)&&m(t,s,e[s]);return t},f=(t,e)=>I(t,C(e));import{a as c}from"./axios.9e3aeb74.js";import{D as S,S as $,F as D}from"./Filter.935f265c.js";import{r as l,o as N,a as R,h as o,s as x,t as U,b as d,w as j,p as L,k as B,z as u}from"./vendor.63776c49.js";import{_ as A}from"./index.fc511753.js";const E={components:{Datagrid:S,Search:$,Filter:D},data(){return{headers:[{text:"Niveau",value:"niveau"},{text:"Date De Cr\xE9ation",value:"created_at"}],anneeUniversitaire:"",anneeId:this.$route.params.anneeId,formations:[],searchQuery:"",selectedFilter:"",filterOptions:[{text:"Niveau",value:"niveau"},{text:"Date De Cr\xE9ation",value:"created_at"}]}},methods:{fetchAnneeUniversitaire(){const t=localStorage.getItem("userToken");c.get(`http://localhost:8000/api/annee-universitaire/${this.anneeId}`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>{console.log(e.data),this.anneeUniversitaire=`${e.data.annee_debut}/${e.data.annee_fin}`}).catch(e=>console.error("Erreur lors de la r\xE9cup\xE9ration des niveaux de l'ann\xE9e",e))},fetchFormations(){console.log(this.anneeId);const t=localStorage.getItem("userToken");c.get(`http://localhost:8000/api/annee-universitaire/${this.anneeId}/annee-formation`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>{console.log(e.data),this.formations=e.data.map(s=>f(v({},s),{created_at:s.created_at.split("T")[0]}))}).catch(e=>console.error("Erreur lors de la r\xE9cup\xE9ration des niveaux de l'ann\xE9e",e))},createFormation(){this.$router.push({name:"CreateNiveau",params:{anneeId:this.anneeId}})},handleClick(t){this.$router.push({name:"UEList",params:{formationId:this.anneeId,niveauId:t.id}})},addRow(t){this.$router.push({name:"ParcoursList",params:{formationId:this.anneeId,niveauId:t.id}})},deleteRow(t){if(confirm(`\xCAtes-vous s\xFBr de vouloir supprimer le niveau : ${t.niveau}  ?`)){const s=localStorage.getItem("userToken");c.delete(`http://localhost:8000/api/annee-universitaire/${this.anneeId}/annee-formation/delete/${t.id}`,{headers:{Authorization:`Bearer ${s}`}}).then(()=>{alert("Niveau supprim\xE9e"),this.fetchFormations()}).catch(h=>{console.error("Erreur lors de la suppression du niveau :",h),alert("\xC9chec de la suppression du niveau.")})}}},computed:{filteredRows(){return this.formations.filter(t=>{const e=this.searchQuery.toLowerCase();return Object.keys(t).some(s=>String(t[s]).toLowerCase().includes(e))})}},created(){this.fetchAnneeUniversitaire(),this.fetchFormations()}},i=t=>(L("data-v-681395c5"),t=t(),B(),t),T={class:"flex flex-col h-screen"},z={class:"text-center text-5xl font-bold my-4"},O=i(()=>o("br",null,null,-1)),Q={class:"flex-1 flex flex-col items-center justify-center"},V={class:"w-full max-w-6xl px-4"},q={class:"flex justify-between items-center mb-2"},M={class:"flex gap-2"},P={class:"shadow-lg rounded-lg overflow-hidden"},G={class:"flex items-center justify-center space-x-2"},H=["onClick"],J=i(()=>o("span",{class:"material-symbols-outlined"}," fork_left ",-1)),K=[J],W=["onClick"],X=i(()=>o("span",{class:"material-icons"},"edit",-1)),Y=[X],Z=["onClick"],ee=i(()=>o("span",{class:"material-icons"},"delete",-1)),te=[ee];function se(t,e,s,h,r,n){const g=l("Search"),k=l("Filter"),w=l("Datagrid");return N(),R("div",T,[o("h1",z,[x("Les Formations de l'ann\xE9e universitaire "),O,x(" "+U(this.anneeUniversitaire),1)]),o("main",Q,[o("div",V,[o("div",q,[o("div",M,[d(g,{"onUpdate:query":e[0]||(e[0]=a=>r.searchQuery=a)}),d(k,{options:r.filterOptions,"onUpdate:filter":e[1]||(e[1]=a=>r.selectedFilter=a)},null,8,["options"])]),o("button",{onClick:e[2]||(e[2]=a=>n.createFormation()),class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-700 transition duration-150"},"Nouvelle Formation")]),o("div",P,[d(w,{onClickRow:n.handleClick,headers:r.headers,rows:n.filteredRows,actions:""},{"row-actions":j(({row:a})=>[o("div",G,[o("button",{onClick:u(p=>n.addRow(a),["stop"]),class:"flex items-center justify-center p-2 rounded text-gray-500 hover:text-red-500 transition duration-150"},K,8,H),o("button",{onClick:u(p=>t.editRow(a),["stop"]),class:"flex items-center justify-center p-2 rounded text-gray-500 hover:text-gray-700 transition duration-150"},Y,8,W),o("button",{onClick:u(p=>n.deleteRow(a),["stop"]),class:"flex items-center justify-center p-2 rounded text-gray-500 hover:text-red-500 transition duration-150"},te,8,Z)])]),_:1},8,["onClickRow","headers","rows"])])])])])}var ce=A(E,[["render",se],["__scopeId","data-v-681395c5"]]);export{ce as default};
