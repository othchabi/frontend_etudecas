var k=Object.defineProperty,w=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var u=(t,e,s)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,_=(t,e)=>{for(var s in e||(e={}))b.call(e,s)&&u(t,s,e[s]);if(p)for(var s of p(e))S.call(e,s)&&u(t,s,e[s]);return t},m=(t,e)=>w(t,y(e));import{D as U,S as C,F as I}from"./Filter.935f265c.js";import{a as i}from"./axios.9e3aeb74.js";import{_ as D}from"./index.fc511753.js";import{r as c,o as B,a as F,h as o,b as l,w as j,p as q,k as A}from"./vendor.63776c49.js";const E={components:{Datagrid:U,Search:C,Filter:I},data(){return{searchQuery:"",selectedFilter:"",filterOptions:[{text:"Nom",value:"nom"},{text:"Pr\xE9nom",value:"prenom"},{text:"Email",value:"email"},{text:"R\xF4les",value:"roles"},{text:"Date d'inscription ",value:"inscriptionDate"}],headers:[{text:"Nom",value:"nom"},{text:"Pr\xE9nom",value:"prenom"},{text:"Email",value:"email"},{text:"R\xF4les",value:"roles"},{text:"Date d'inscription ",value:"inscriptionDate"}],requests:[]}},computed:{filteredRequests(){return this.requests.filter(t=>this.searchQuery?(this.selectedFilter?t[this.selectedFilter].toString().toLowerCase():t.email.toString().toLowerCase()).includes(this.searchQuery.toLowerCase()):!0)}},methods:{nameById(t){return{1:"Enseignant",2:"Responsable ann\xE9e",3:"Responsable master",4:"Administrateur"}[t]},fetchInactiveUsers(){const t=localStorage.getItem("userToken");i.get("http://localhost:8000/api/inactive-users",{headers:{Authorization:`Bearer ${t}`}}).then(e=>{this.requests=e.data.map(s=>m(_({},s),{roles:s.roles.map(h=>this.nameById(h.id)).join(", "),inscriptionDate:s.created_at.split("T")[0]})),console.log(this.requests)}).catch(e=>{console.error("There was an error fetching the inactive users:",e)})},activateUser(t){const e=localStorage.getItem("userToken");i.post(`http://localhost:8000/api/user/activate/${t}`,{},{headers:{Authorization:`Bearer ${e}`}}).then(()=>{this.fetchInactiveUsers(),console.log(`User ${t} activated.`)}).catch(s=>{console.error("Error activating user:",s)})},rejectUser(t){const e=localStorage.getItem("userToken");console.log(e),i.post(`http://localhost:8000/api/user/delete/${t}`,{},{headers:{Authorization:`Bearer ${e}`}}).then(()=>{this.fetchInactiveUsers(),console.log(`User ${t} deleted.`)}).catch(s=>{console.error("Error deleting user:",s)})}},created(){this.fetchInactiveUsers()}},d=t=>(q("data-v-899ba858"),t=t(),A(),t),R={class:"flex flex-col h-screen"},$=d(()=>o("h1",{class:"text-center text-5xl font-bold my-4"},"Demandes d'inscription en attente",-1)),T={class:"flex-1 flex flex-col items-center justify-center"},N={class:"w-full max-w-6xl px-4"},Q={class:"flex justify-between items-center mb-2"},z={class:"flex gap-2"},L={class:"shadow-lg rounded-lg overflow-hidden"},M={class:"flex items-center justify-center space-x-2"},O=["onClick"],P=d(()=>o("span",{class:"material-icons"},"check_circle",-1)),V=[P],G=["onClick"],H=d(()=>o("span",{class:"material-icons"},"cancel",-1)),J=[H];function K(t,e,s,h,a,n){const v=c("Search"),f=c("Filter"),x=c("Datagrid");return B(),F("div",R,[$,o("main",T,[o("div",N,[o("div",Q,[o("div",z,[l(v,{"onUpdate:query":e[0]||(e[0]=r=>a.searchQuery=r)}),l(f,{options:a.filterOptions,"onUpdate:filter":e[1]||(e[1]=r=>a.selectedFilter=r)},null,8,["options"])])]),o("div",L,[l(x,{headers:a.headers,rows:n.filteredRequests,actions:""},{"row-actions":j(({row:r})=>[o("div",M,[o("button",{onClick:g=>n.activateUser(r.id),class:"icon-button"},V,8,O),o("button",{onClick:g=>n.rejectUser(r.id),class:"icon-button"},J,8,G)])]),_:1},8,["headers","rows"])])])])])}var te=D(E,[["render",K],["__scopeId","data-v-899ba858"]]);export{te as default};
